<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="OrderListScreen" t-inherit="sh_pos_order_list.OrderListScreen" t-inherit-mode="extension" owl="1">
        <xpath expr="//th[hasclass('pos_order_state_th')]" position="after">
            <t t-if="env.pos.config.sh_allow_return">
                <th>Return Status</th>
                <th></th>
            </t>
            <t t-if="env.pos.config.sh_allow_exchange">
                <th></th>
            </t>
        </xpath>
        <xpath expr="//div[hasclass('sh_service_back_btn')]" position="after">
            <span class="button return_order_button" t-on-click="return_order_filter">
                <t t-if="!env.isMobile"> Return Orders <img src="/sh_pos_order_return_exchange/static/src/img/return_button.svg" class="order_return" /></t>
                <t t-else="">
                    <img src="/sh_pos_order_return_exchange/static/src/img/return_button.svg" class="order_return" />
                </t>
            </span>
        </xpath>
        <xpath expr="//td[hasclass('pos_order_state')]" position="after">
            <t t-if="env.pos.config.sh_allow_return">
                <td>
                    <t t-if="pos_order.return_status">
                        <t t-if="pos_order.return_status == 'nothing_return'">
                            -
                        </t>
                        <t t-if="pos_order.return_status == 'partialy_return'">
                            Partially-Returned
                        </t>
                        <t t-if="pos_order.return_status == 'fully_return'">
                            Fully-Returned
                        </t>
                    </t>
                </td>
                <td class="order_return">
                    <t t-if="(pos_order.return_status != 'fully_return') and (!pos_order.is_return_order)">
                        <span class="tool" data-tip="Return"><i class="fa fa-reply order_return" aria-hidden="true" t-on-click="return_pos_order"></i></span>
                    </t>
                </td>
            </t>
            <t t-if="env.pos.config.sh_allow_exchange">
                <td class="order_exchange">
                    <t t-if="pos_order.return_status != 'fully_return'">
                        <i class="fa fa-exchange order_exchange" aria-hidden="true" t-on-click="exchange_pos_order"></i>
                    </t>
                </td>
            </t>
        </xpath>

        <xpath expr="//table[hasclass('inner_data_table')]" position="replace">
            <table class="inner_data_table">
                <t t-if="pos_order.return_status != 'nothing_return'">
                    <tr t-att-id="pos_order.pos_reference.split(' ')[1]" class="order_data_row order_data_header">
                        <td>
                            <b>Return Order Reference : </b>
                        </td>
                        <td colspan="5">
                            <t t-if="pos_order.old_pos_reference">
                                <t t-esc="pos_order.old_pos_reference" />
                            </t>
                        </td>
                    </tr>
                </t>
                <tr t-att-id="pos_order.pos_reference.split(' ')[1]" class="order_data_row order_data_header">
                    <th>Product</th>
                    <th>Qty.</th>
                    <t t-if="pos_order.return_status != 'nothing_return'">
                        <th>Return Quantity</th>
                    </t>
                    <th>Discount (%)</th>
                    <th>Unit Price</th>
                    <th>Sub Total</th>
                </tr>
                <t t-if="pos_order.sh_line_id">
                    <t t-foreach="pos_order.sh_line_id" t-as="pos_order_line">
                        <t t-if="env.pos.db.order_line_by_uid and env.pos.db.order_line_by_uid[pos_order_line]">
                            <tr t-att-id="env.pos.db.order_line_by_uid[pos_order_line].sh_line_id" class="order_data_row order-data" style="border-bottom: 1px solid #ccc;">
                                <td class="product_td">
                                    <t
                                        t-if="(env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_exchangeable) or (env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_returnable)"
                                    >
                                        <t
                                            t-if="(env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_exchangeable) and (env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_returnable)"
                                        >
                                            <t t-esc="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).display_name" /><span class="no_return_exchange"> (Non-Returnable) (Non-Exchangeable)</span>
                                        </t>
                                        <t t-else="">
                                            <t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_exchangeable">
                                                <t t-esc="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).display_name" /><span class="no_exchange"> (Non-Exchangeable)</span>
                                            </t>
                                            <t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).sh_product_non_returnable">
                                                <t t-esc="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).display_name" /> <span class="no_return"> (Non-Returnable)</span>
                                            </t>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <t t-esc="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).display_name" />
                                    </t>
                                </td>
                                <td><t t-esc="env.pos.db.order_line_by_uid[pos_order_line].qty" /></td>
                                <t t-if="pos_order.return_status != 'nothing_return'">
                                    <td>
                                        <t t-if="env.pos.db.order_line_by_uid[pos_order_line] and env.pos.db.order_line_by_uid[pos_order_line].sh_return_qty">
                                            <t t-esc="env.pos.db.order_line_by_uid[pos_order_line].sh_return_qty" />
                                        </t>
                                    </td>
                                </t>
                                <td><t t-esc="env.pos.db.order_line_by_uid[pos_order_line].discount" /></td>
                                <td>
                                	<t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).lst_price">
                                		<t t-esc="env.pos.format_currency(env.pos.db.get_product_by_id(env.pos.db.order_line_by_uid[pos_order_line].product_id).lst_price)" />
                                	</t>
                               	</td>
                                <td><t t-esc="env.pos.format_currency(env.pos.db.order_line_by_uid[pos_order_line].qty * env.pos.db.order_line_by_uid[pos_order_line].price_unit)" /></td>
                            </tr>
                        </t>
                    </t>
                </t>
                <t t-else="">
                    <t t-foreach="pos_order.lines" t-as="pos_order_line">
                        <t t-if="env.pos.db.order_line_by_id and env.pos.db.order_line_by_id[pos_order_line]">
                            <tr t-att-id="env.pos.db.order_line_by_id[pos_order_line].id" class="order_data_row order-data" style="border-bottom: 1px solid #ccc;">
                                <td class="product_td">
                                    <t
                                        t-if="(env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_exchangeable) or (env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_returnable)"
                                    >
                                        <t
                                            t-if="(env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_exchangeable) and (env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_returnable)"
                                        >
                                            <t t-esc="env.pos.db.order_line_by_id[pos_order_line].product_id[1]" /><span class="no_return_exchange"> (Non-Returnable) (Non-Exchangeable)</span>
                                        </t>
                                        <t t-else="">
                                            <t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_exchangeable">
                                                <t t-esc="env.pos.db.order_line_by_id[pos_order_line].product_id[1]" /><span class="no_exchange"> (Non-Exchangeable)</span>
                                            </t>
                                            <t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).sh_product_non_returnable">
                                                <t t-esc="env.pos.db.order_line_by_id[pos_order_line].product_id[1]" /> <span class="no_return"> (Non-Returnable)</span>
                                            </t>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <t t-esc="env.pos.db.order_line_by_id[pos_order_line].product_id[1]" />
                                    </t>
                                </td>
                                <td><t t-esc="env.pos.db.order_line_by_id[pos_order_line].qty" /></td>
                                <t t-if="pos_order.return_status != 'nothing_return'">
                                    <td>
                                        <t t-if="env.pos.db.order_line_by_id[pos_order_line] and env.pos.db.order_line_by_id[pos_order_line].sh_return_qty">
                                            <t t-esc="env.pos.db.order_line_by_id[pos_order_line].sh_return_qty" />
                                        </t>
                                    </td>
                                </t>
                                <td><t t-esc="env.pos.db.order_line_by_id[pos_order_line].discount" /></td>
                                <td>
                                	<t t-if="env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]) and env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).lst_price">
                                		<t t-esc="env.pos.format_currency(env.pos.db.get_product_by_id(env.pos.db.order_line_by_id[pos_order_line].product_id[0]).lst_price)" />
                                	</t>
                               	</td>
                                <td><t t-esc="env.pos.format_currency(env.pos.db.order_line_by_id[pos_order_line].qty * env.pos.db.order_line_by_id[pos_order_line].price_unit)" /></td>
                            </tr>
                        </t>
                    </t>
                </t>
            </table>
        </xpath>
    </t>

    <t t-name="PaymentScreen" t-inherit="point_of_sale.PaymentScreen" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('back')]" position="after">
            <t t-if="env.pos.get_order().return_order">
                <div class="button cancel" t-on-click="cancel_return_order">
                    <span class="back_text">Cancel</span>
                </div>
            </t>
        </xpath>
    </t>
</templates>
